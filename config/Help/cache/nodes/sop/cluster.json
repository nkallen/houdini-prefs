{"body": [{"indent": 0, "text": ["Cluster"], "type": "title", "extent": [0, 12], "level": 0}, {"indent": 0, "type": "summary", "extent": [111, 208], "text": ["Low-level machinery to cluster points based on their positions (or any vector attribute)."]}, {"body": [{"indent": 0, "type": "para", "extent": [223, 449], "text": ["This is a low-level node that can output either points with a cluster attribute or cluster centers. For a higher-level clustering node that can do both at the same time, see the ", {"text": ["Cluster points node"], "fullpath": "/nodes/sop/clusterpoints", "scheme": "Node", "type": "link", "value": "/nodes/sop/clusterpoints"}, "."]}, {"indent": 0, "type": "para", "extent": [449, 637], "text": ["This node creates a ", {"text": ["cluster"], "type": "code"}, " integer attribute on the points which indicates the cluster number the point belongs to (all points in the same cluster will have the same ", {"text": ["cluster"], "type": "code"}, " value)."]}, {"indent": 0, "type": "para", "extent": [637, 720], "text": ["This node uses the ", {"text": ["K-means clustering algorithm"], "scheme": "Wp", "type": "link", "exists": true, "value": "http://en.wikipedia.org/wiki/K-means"}, " to group the points."]}, {"body": [{"body": [{"indent": 4, "type": "para", "extent": [725, 1047], "text": ["To visualize the clusters as colors, you can add a ", {"text": ["Color node"], "fullpath": "/nodes/sop/color", "scheme": "Node", "type": "link", "value": "/nodes/sop/color"}, " with ", {"text": ["Color type"], "type": "ui"}, " set to \"Random from attribute\" and ", {"text": ["Attribute"], "type": "ui"}, " set to ", {"text": ["cluster"], "type": "code"}, ". (To see the colors in the geometry viewport, you will need to also add an ", {"text": ["Add node"], "fullpath": "/nodes/sop/add", "scheme": "Node", "type": "link", "value": "/nodes/sop/add"}, " with ", {"text": ["Particles \u25b8 Add Particle System"], "type": "ui"}, " turned on.)"]}], "indent": 0, "role": "item", "type": "tip", "extent": [720, 725]}], "container": true, "role": "item_group", "type": "tip_group"}], "indent": 0, "level": 2, "text": ["Overview"], "extent": [208, 223], "container": true, "type": "h", "id": null}, {"body": [{"indent": 0, "type": "para", "extent": [1104, 1545], "text": ["The K-means clustering algorithm used by this node is sensitive to the randomly chosen initial cluster centers, especially when you create a small number of clusters. For example, if you have geometry divided into two parts that are far from each other, you might end up with all the points of part A in one cluster, and the points of part B divided into many clusters, just because none of the initial centers happened to be near part A."]}, {"indent": 0, "type": "para", "extent": [1545, 1603], "text": [{"text": "", "fullpath": "/images/nodes/sop/clusterpoints_bad_clusters.png", "scheme": "Image", "type": "link", "value": "/images/nodes/sop/clusterpoints_bad_clusters.png"}]}, {"indent": 0, "type": "para", "extent": [1603, 1690], "text": ["In this case you can change the ", {"text": ["Seed"], "type": "ui"}, " parameter until you get a better clustering."]}], "indent": 0, "level": 2, "text": ["Change the Seed to change the clustering"], "extent": [1047, 1104], "container": true, "type": "h", "id": "seeding"}, {"body": [{"indent": 0, "type": "para", "extent": [1728, 2000], "text": ["This node lets you cluster by blending multiple attributes (by increasing the ", {"text": ["Control attributes"], "type": "ui"}, " parameter). Each attribute has a ", {"text": ["Weight"], "type": "ui"}, " parameter controlling its linear contribution to the proximity measurement that controls which cluster each point goes into."]}, {"indent": 0, "type": "para", "extent": [2000, 2178], "text": ["For some attributes, you may find that a linear scale is not what you want. The example that motivated the threshold feature is clustering points by ", {"text": ["impact time"], "type": "em"}, ". For example:"]}, {"body": [{"indent": 0, "blevel": 2, "type": "bullet", "extent": [2178, 2423], "text": ["You use an ", {"text": ["Impact Analysis DOP"], "fullpath": "/nodes/dop/impactanalysis", "scheme": "Node", "type": "link", "value": "/nodes/dop/impactanalysis"}, " to create points where RBD objects hit the ground, in order to create dust clouds. The impact points have an ", {"text": ["impacttime"], "type": "code"}, " attribute containing a time stamp of when the impact occurred."]}, {"indent": 0, "blevel": 2, "type": "bullet", "extent": [2423, 2512], "text": ["You want to cluster the impact points to put them in separate fluid simulation boxes."]}, {"indent": 0, "blevel": 2, "type": "bullet", "extent": [2512, 2748], "text": ["You want to sort by location (so points close to each other are in the same box), but also by ", {"text": ["impact time"], "type": "em"}, " (so impact points that occur far apart from each other in time are in separate boxes, even if they occur at the same place)."]}, {"indent": 0, "blevel": 2, "type": "bullet", "extent": [2748, 2949], "text": ["You could use two \"control attributes\", position (", {"text": ["P"], "type": "code"}, ") and ", {"text": ["impacttime"], "type": "code"}, ", to control clustering, with a higher ", {"text": ["Weight"], "type": "ui"}, " value for ", {"text": ["impacttime"], "type": "code"}, " to group the points by impact time, then by position."]}, {"indent": 0, "blevel": 2, "type": "bullet", "extent": [2949, 3198], "text": ["However, the linear nature of the ", {"text": ["Weight"], "type": "ui"}, " parameter may make it difficult to pick the right weight value to get the behavior you want, where impacts that are \"close enough\" in time go into the same box, but otherwise are clustered separately."]}], "container": true, "type": "bullet_group"}, {"indent": 0, "type": "para", "extent": [3198, 3424], "text": ["This is what the threshold feature is useful for. Instead of a linear weight, it adds a high \"penalty\" to the final distance calculation if the distance of a certain attribute is more than a certain amount (the ", {"text": ["threshold"], "type": "em"}, ")."]}, {"indent": 0, "type": "para", "extent": [3424, 3469], "text": [{"text": "", "fullpath": "/nodes/images/cluster_threshold.png", "scheme": "Image", "type": "link", "value": "/nodes/images/cluster_threshold.png"}]}, {"indent": 0, "type": "para", "extent": [3469, 3710], "text": ["In this example, the red points represent early impacts, and the green points represent later impacts. You can see that in some places points impacts that overlap in position are sorted into different boxes based on different impact times."]}, {"indent": 0, "type": "para", "extent": [3710, 3746], "text": [{"text": "", "fullpath": "/images/cluster_impact.png", "scheme": "Image", "type": "link", "value": "/images/cluster_impact.png"}]}], "indent": 0, "level": 2, "text": ["Threshold attribute"], "extent": [1690, 1728], "container": true, "type": "h", "id": "threshold"}, {"body": [{"body": [{"body": [{"indent": 4, "type": "para", "extent": [3774, 3954], "text": ["The input points to sort into clusters. This node will create an attribute (by default called ", {"text": ["cluster"], "type": "code"}, ") on each point containing the cluster number the point belongs to."]}], "indent": 0, "type": "dt", "extent": [3754, 3774], "text": ["Points to Cluster"]}, {"body": [{"indent": 4, "type": "para", "extent": [3971, 4141], "text": ["If this input is connected, the node will use these points as the centers of the clusters, instead of calculating average cluster centers from the input points."]}, {"indent": 4, "type": "para", "extent": [4141, 4237], "text": ["If this input is connected, several parameters such as the number of clusters are ignored."]}], "indent": 0, "type": "dt", "extent": [3954, 3971], "text": ["Cluster Centers"]}], "container": true, "type": "dt_group"}], "indent": 0, "level": 1, "text": "Inputs", "role": "section", "extent": [3746, 3754], "container": true, "type": "inputs_section", "id": "inputs"}, {"body": [{"body": [{"body": [{"indent": 4, "type": "para", "extent": [4287, 4351], "text": ["The number of clusters to group the input points into."]}], "indent": 0, "text": ["Clusters"], "role": "item", "attrs": {"id": "num_clusters"}, "extent": [4249, 4260], "type": "parameters_item"}, {"body": [{"indent": 4, "type": "para", "extent": [4399, 4547], "text": ["The name of the attribute to set on the points. This attribute will contain the cluster number the point belongs to. The default is ", {"text": ["cluster"], "type": "code"}, "."]}], "indent": 0, "text": ["Cluster Attribute"], "role": "item", "attrs": {"id": "cluster_attrib"}, "extent": [4351, 4370], "type": "parameters_item"}, {"body": [{"indent": 4, "type": "para", "extent": [4599, 4715], "text": ["Instead of outputting the input points with a cluster attribute, output the cluster centers as new points."]}, {"indent": 4, "type": "para", "extent": [4715, 4975], "text": ["If you want both the cluster centers as points and the clustered input points, you can use two cluster nodes, with one set to output cluster centers. Connect the output of the \"cluster centers\" node to the second input of the \"clustered points\" node."]}, {"indent": 4, "type": "para", "extent": [4975, 5138], "text": ["Alternatively you can use the ", {"text": ["Cluster points node"], "fullpath": "/nodes/sop/clusterpoints", "scheme": "Node", "type": "link", "value": "/nodes/sop/clusterpoints"}, ", which can output both the clustered points and cluster centers automatically."]}], "indent": 0, "text": ["Output Cluster Centers"], "role": "item", "attrs": {"id": "output_center"}, "extent": [4547, 4571], "type": "parameters_item"}, {"body": [{"indent": 4, "type": "para", "extent": [5185, 5417], "text": ["The number of vector attributes to blend together to determine which points should be grouped together. The default is to use the position attribute (", {"text": ["P"], "type": "code"}, "), so the node will cluster together points that are near each other."]}], "indent": 0, "text": ["Control Attributes"], "role": "item", "attrs": {"id": "num_controls"}, "extent": [5138, 5158], "type": "parameters_item"}, {"body": [{"indent": 4, "type": "para", "extent": [5465, 5600], "text": ["The name of a vector attribute to use to cluster points. Points with close values of this attribute will be grouped together."]}], "indent": 0, "text": ["Control Attribute"], "role": "item", "attrs": {"id": "control_attrib"}, "extent": [5417, 5436], "type": "parameters_item"}, {"body": [{"indent": 4, "type": "para", "extent": [5637, 5837], "text": ["The strength of a particular vector attribute in controlling which points should be grouped together. This is a linear scale. For a more discrete grouping method, use the ", {"fragment": "#threshold", "text": ["threshold"], "value": "#threshold", "fullpath": "/nodes/sop/cluster#threshold", "scheme": null, "type": "link"}, "."]}], "indent": 0, "text": ["Weight"], "role": "item", "attrs": {"id": "control_weight"}, "extent": [5600, 5608], "type": "parameters_item"}, {"body": [{"indent": 4, "type": "para", "extent": [5874, 5956], "text": ["Higher numbers give more accurate clustering but take longer to compute."]}, {"indent": 4, "type": "para", "extent": [5956, 6241], "text": ["The K-means clustering algorithm starts with random cluster centers, assigns points to clusters based on their distance from the centers, then moves to centers based on the points in the cluster and repeats. This iterative process usually converges toward more accurate clusters."]}], "indent": 0, "text": ["Iterations"], "role": "item", "attrs": {"id": "iterations"}, "extent": [5837, 5849], "type": "parameters_item"}, {"body": [{"indent": 4, "type": "para", "extent": [6273, 6370], "text": ["Changing this will usually generate different groupings and cluster number assignments."]}, {"indent": 4, "type": "para", "extent": [6370, 6558], "text": ["The K-means clustering algorithm starts with random cluster centers and then iterates to refine the cluster centers. Changing the initial positions can potentially change the groups."]}], "indent": 0, "text": ["Seed"], "role": "item", "attrs": {"id": "random_seed"}, "extent": [6241, 6247], "type": "parameters_item"}, {"body": [{"indent": 4, "type": "para", "extent": [6610, 6872], "text": ["Use the value of this float or integer attribute as a ", {"fragment": "#threshold", "text": ["threshold"], "value": "#threshold", "fullpath": "/nodes/sop/cluster#threshold", "scheme": null, "type": "link"}, ", where points that aren\u2019t \"close enough\" (within the ", {"text": ["Goal threshold"], "type": "ui"}, ") in this attribute will not be grouped together, even if they are close according to the control attribute."]}], "indent": 0, "text": ["Threshold Attribute"], "role": "item", "attrs": {"id": "threshold_attrib"}, "extent": [6558, 6579], "type": "parameters_item"}, {"body": [{"indent": 4, "type": "para", "extent": [6911, 7008], "text": ["The strength of the ", {"text": ["Threshold Attribute"], "type": "ui"}, ". Set this to ", {"text": ["0"], "type": "code"}, " to turn off the threshold."]}], "indent": 0, "text": ["Weight"], "role": "item", "attrs": {"id": "threshold_weight"}, "extent": [6872, 6880], "type": "parameters_item"}, {"body": [{"indent": 4, "type": "para", "extent": [7059, 7388], "text": ["The initial \"cutoff\" value of the threshold attribute, used in the first clustering iteration. The threshold value works better if it\u2019s high at first (so the control attribute dominates) and lowers toward the ", {"text": ["Goal threshold"], "type": "ui"}, " at each iteration. As a rule of thumb, start by setting this to 4 times the ", {"text": ["Goal threshold"], "type": "ui"}, "."]}], "indent": 0, "text": ["Initial Threshold"], "role": "item", "attrs": {"id": "initial_threshold"}, "extent": [7008, 7027], "type": "parameters_item"}, {"body": [{"indent": 4, "type": "para", "extent": [7434, 7623], "text": ["The \"cutoff\" value of the threshold attribute, used in the final clustering iteration. Points with values farther apart than this value will be unlikely to end up in the same cluster."]}], "indent": 0, "text": ["Goal Threshold"], "role": "item", "attrs": {"id": "final_threshold"}, "extent": [7388, 7404], "type": "parameters_item"}], "container": true, "role": "item_group", "type": "parameters_item_group"}], "indent": 0, "level": 1, "text": "Parameters", "role": "section", "extent": [4237, 4249], "container": true, "type": "parameters_section", "id": "parameters"}, {"body": [{"body": [{"indent": 0, "blevel": 2, "type": "bullet", "extent": [7632, 7660], "text": [{"text": "", "fullpath": "/nodes/sop/clusterpoints", "scheme": "Node", "type": "link", "value": "/nodes/sop/clusterpoints"}]}, {"indent": 0, "blevel": 2, "type": "bullet", "extent": [7660, 7683], "text": [{"text": "", "fullpath": "/nodes/sop/partition", "scheme": "Node", "type": "link", "value": "/nodes/sop/partition"}]}, {"indent": 0, "blevel": 2, "type": "bullet", "extent": [7683, 7711], "text": [{"text": "", "fullpath": "/nodes/dop/impactanalysis", "scheme": "Node", "type": "link", "value": "/nodes/dop/impactanalysis"}]}], "container": true, "type": "bullet_group"}], "indent": 0, "level": 1, "text": "Related", "role": "section", "extent": [7623, 7632], "container": true, "type": "related_section", "id": "related"}], "summary": ["Low-level machinery to cluster points based on their positions (or any vector attribute)."], "type": "root", "attrs": {"version": null, "tags": "lowlevel, cluster, points", "namespace": null, "internal": "cluster", "context": "sop", "type": "node", "icon": "SOP/cluster"}, "title": ["Cluster"]}