{"body": [{"indent": 0, "text": ["Copying and instancing point attributes"], "type": "title", "extent": [0, 44], "level": 0}, {"indent": 0, "type": "para", "extent": [44, 191], "text": ["When you copy or instance geometry onto points, Houdini looks for specific attributes on the destination points to customize each copy/instance."]}, {"body": [{"body": [{"body": [{"indent": 0, "text": [{"text": ["orient"], "type": "code"}, " "], "role": "td", "extent": [252, 264], "type": "cell"}, {"indent": 4, "text": ["float4 (quaternion) "], "role": "td", "extent": [264, 290], "type": "cell"}, {"body": [{"indent": 8, "type": "para", "extent": [290, 323], "text": ["Orientation of the copy"]}], "role": "td", "type": "cell"}], "divider": false, "type": "row"}, {"body": [{"indent": 0, "text": [{"text": ["pscale"], "type": "code"}, " "], "role": "td", "extent": [323, 334], "type": "cell"}, {"indent": 4, "text": ["float "], "role": "td", "extent": [334, 346], "type": "cell"}, {"body": [{"indent": 8, "type": "para", "extent": [346, 369], "text": ["Uniform scale"]}], "role": "td", "type": "cell"}], "divider": false, "type": "row"}, {"body": [{"indent": 0, "text": [{"text": ["scale"], "type": "code"}, " "], "role": "td", "extent": [369, 379], "type": "cell"}, {"indent": 4, "text": ["float3 "], "role": "td", "extent": [379, 392], "type": "cell"}, {"body": [{"indent": 8, "type": "para", "extent": [392, 419], "text": ["Non-uniform scale"]}], "role": "td", "type": "cell"}], "divider": false, "type": "row"}, {"body": [{"indent": 0, "text": [{"text": ["N"], "type": "code"}, " "], "role": "td", "extent": [419, 425], "type": "cell"}, {"indent": 4, "text": ["vector "], "role": "td", "extent": [425, 438], "type": "cell"}, {"body": [{"indent": 8, "type": "para", "extent": [438, 492], "text": ["Normal (+Z axis of the copy, if no ", {"text": ["orient"], "type": "code"}, ")"]}], "role": "td", "type": "cell"}], "divider": false, "type": "row"}, {"body": [{"indent": 0, "text": [{"text": ["up"], "type": "code"}, " "], "role": "td", "extent": [492, 499], "type": "cell"}, {"indent": 4, "text": ["vector "], "role": "td", "extent": [499, 512], "type": "cell"}, {"body": [{"indent": 8, "type": "para", "extent": [512, 581], "text": ["Up vector of the copy (+Y axis of the copy, if no ", {"text": ["orient"], "type": "code"}, ")"]}], "role": "td", "type": "cell"}], "divider": false, "type": "row"}, {"body": [{"indent": 0, "text": [{"text": ["v"], "type": "code"}, " "], "role": "td", "extent": [581, 587], "type": "cell"}, {"indent": 4, "text": ["vector "], "role": "td", "extent": [587, 600], "type": "cell"}, {"body": [{"indent": 8, "type": "para", "extent": [600, 699], "text": ["Velocity of the copy (motion blur, and used as +Z axis of the copy if no ", {"text": ["orient"], "type": "code"}, " or ", {"text": ["N"], "type": "code"}, ")"]}], "role": "td", "type": "cell"}], "divider": false, "type": "row"}, {"body": [{"indent": 0, "text": [{"text": ["rot"], "type": "code"}, " "], "role": "td", "extent": [699, 707], "type": "cell"}, {"indent": 4, "text": ["float4 (quaternion) "], "role": "td", "extent": [707, 733], "type": "cell"}, {"body": [{"indent": 8, "type": "para", "extent": [733, 811], "text": ["Additional rotation (applied after the orientation attributes above)"]}], "role": "td", "type": "cell"}], "divider": false, "type": "row"}, {"body": [{"indent": 0, "text": [{"text": ["P"], "type": "code"}, " "], "role": "td", "extent": [811, 817], "type": "cell"}, {"indent": 4, "text": ["vector "], "role": "td", "extent": [817, 830], "type": "cell"}, {"body": [{"indent": 8, "type": "para", "extent": [830, 863], "text": ["Translation of the copy"]}], "role": "td", "type": "cell"}], "divider": false, "type": "row"}, {"body": [{"indent": 0, "text": [{"text": ["trans"], "type": "code"}, " "], "role": "td", "extent": [863, 873], "type": "cell"}, {"indent": 4, "text": ["vector "], "role": "td", "extent": [873, 886], "type": "cell"}, {"body": [{"indent": 8, "type": "para", "extent": [886, 939], "text": ["Translation of the copy, in addition to ", {"text": ["P"], "type": "code"}]}], "role": "td", "type": "cell"}], "divider": false, "type": "row"}, {"body": [{"indent": 0, "text": [{"text": ["pivot"], "type": "code"}, " "], "role": "td", "extent": [939, 949], "type": "cell"}, {"indent": 4, "text": ["vector "], "role": "td", "extent": [949, 962], "type": "cell"}, {"body": [{"indent": 8, "type": "para", "extent": [962, 1002], "text": ["Local pivot point for the copy"]}], "role": "td", "type": "cell"}], "divider": false, "type": "row"}, {"body": [{"indent": 0, "text": [{"text": ["transform"], "type": "code"}, " "], "role": "td", "extent": [1002, 1016], "type": "cell"}, {"indent": 4, "text": ["3\u00d73 or 4\u00d74 matrix "], "role": "td", "extent": [1016, 1040], "type": "cell"}, {"body": [{"indent": 8, "type": "para", "extent": [1040, 1145], "text": ["Transformation matrix overriding everything except translations from ", {"text": ["P"], "type": "code"}, ", ", {"text": ["pivot"], "type": "code"}, ", and ", {"text": ["trans"], "type": "code"}, "."]}], "role": "td", "type": "cell"}], "divider": false, "type": "row"}, {"body": [{"indent": 0, "text": [{"text": ["shop_materialpath"], "type": "code"}, " "], "role": "td", "extent": [1145, 1167], "type": "cell"}, {"indent": 4, "text": ["string "], "role": "td", "extent": [1167, 1180], "type": "cell"}, {"body": [{"indent": 8, "type": "para", "extent": [1180, 1415], "text": ["Path to a material. You can add this attribute to points using the ", {"text": ["Material surface node"], "fullpath": "/nodes/sop/material", "scheme": "Node", "type": "link", "value": "/nodes/sop/material"}, ". When you instance an object onto a point with this attribute, the instanced object uses the given material."]}, {"indent": 8, "type": "para", "extent": [1415, 1455], "text": ["Not supported in the viewport."]}], "role": "td", "type": "cell"}], "divider": false, "type": "row"}, {"body": [{"indent": 0, "text": [{"text": ["material_override"], "type": "code"}, " "], "role": "td", "extent": [1455, 1477], "type": "cell"}, {"indent": 4, "text": ["string "], "role": "td", "extent": [1477, 1490], "type": "cell"}, {"body": [{"indent": 8, "type": "para", "extent": [1490, 1818], "text": ["A serialized Python dictionary mapping parameter names to values. You can add this attribute to points using the \"override\" controls on the ", {"text": ["Material surface node"], "fullpath": "/nodes/sop/material", "scheme": "Node", "type": "link", "value": "/nodes/sop/material"}, ". When you instance an object onto a point with this attribute, the instanced object applies the given overrides to its material."]}, {"indent": 8, "type": "para", "extent": [1818, 1859], "text": ["Not supported in the viewport."]}], "role": "td", "type": "cell"}], "divider": false, "type": "row"}], "type": "table", "thead": [{"body": [{"indent": 0, "text": ["Name "], "role": "th", "extent": [208, 217], "type": "cell"}, {"indent": 4, "text": ["Type "], "role": "th", "extent": [217, 229], "type": "cell"}, {"indent": 8, "role": "th", "type": "cell", "extent": [229, 252], "text": ["Description "]}], "divider": false, "type": "row"}]}], "indent": 0, "level": 2, "text": ["Attributes"], "extent": [191, 208], "container": true, "type": "h", "id": null}, {"body": [{"body": [{"indent": 0, "blevel": 2, "type": "bullet", "extent": [1876, 1956], "text": ["If ", {"text": ["pivot"], "type": "code"}, " exists, use it as the local transformation of the copy/instance."]}, {"body": [{"body": [{"indent": 4, "blevel": 6, "type": "bullet", "extent": [1995, 2064], "text": ["Use it as a 3\u00d73 or 4\u00d74 matrix to transform the copy/instance."]}], "container": true, "type": "bullet_group"}], "indent": 0, "text": ["If the ", {"text": ["transform"], "type": "code"}, " attribute exists:"], "extent": [1956, 1995], "blevel": 2, "type": "bullet"}, {"body": [{"body": [{"body": [{"body": [{"indent": 8, "blevel": 10, "type": "bullet", "extent": [2151, 2198], "text": ["Use it to orient the copy/instance."]}], "container": true, "type": "bullet_group"}], "indent": 4, "text": ["If the ", {"text": ["orient"], "type": "code"}, " attribute exists:"], "extent": [2111, 2151], "blevel": 6, "type": "bullet"}, {"body": [{"body": [{"indent": 8, "blevel": 10, "type": "bullet", "extent": [2247, 2328], "text": ["Orient the copy/instance using ", {"text": ["N"], "type": "code"}, " as the +Z axis and ", {"text": ["up"], "type": "code"}, " as +Y axis."]}, {"indent": 8, "blevel": 10, "type": "bullet", "extent": [2328, 2395], "text": ["If ", {"text": ["N"], "type": "code"}, " does not exist, use ", {"text": ["v"], "type": "code"}, " (velocity) if it exists."]}], "container": true, "type": "bullet_group"}], "indent": 4, "text": ["If the ", {"text": ["orient"], "type": "code"}, " attributes does not exist:"], "extent": [2198, 2247], "blevel": 6, "type": "bullet"}, {"indent": 4, "blevel": 6, "type": "bullet", "extent": [2395, 2459], "text": ["If the ", {"text": ["rot"], "type": "code"}, " attribute exists, apply it after the above."]}, {"indent": 4, "blevel": 6, "type": "bullet", "extent": [2459, 2571], "text": ["If ", {"text": ["pscale"], "type": "code"}, " exists, use it to scale the to scale the copy/instance (multiplied by ", {"text": ["scale"], "type": "code"}, " if it exists)."]}, {"indent": 4, "blevel": 6, "type": "bullet", "extent": [2571, 2670], "text": ["If ", {"text": ["scale"], "type": "code"}, " exists, use it to scale the copy/instance (multiplied by ", {"text": ["pscale"], "type": "code"}, " if it exists)."]}], "container": true, "type": "bullet_group"}], "indent": 0, "text": ["If the ", {"text": ["transform"], "type": "code"}, " attribute does not exist:"], "extent": [2064, 2111], "blevel": 2, "type": "bullet"}, {"indent": 0, "blevel": 2, "type": "bullet", "extent": [2670, 2734], "text": ["If ", {"text": ["trans"], "type": "code"}, " exists, use it and ", {"text": ["P"], "type": "code"}, " to move the copy/instance."]}], "container": true, "type": "bullet_group"}, {"indent": 0, "type": "para", "extent": [2734, 2756], "text": ["Or, put another way:"]}, {"lang": null, "indent": 0, "type": "pre", "extent": [2756, 3386], "text": ["\nKey: \nX = pivot matrix (translate by -pivot)\nO = orient matrix \nS = scale matrix (scale * pscale) \nL = alignment matrix (*) \nR = rot matrix \nT = trans matrix (trans + P) \nM = transform matrix\n\n(*) The alignment matrix (L) is defined by N or v and up. \n\nIF N exists AND up exists and isn't {0,0,0}: \n   L = mlookatup(N,0,up) \nELSE IF N exists: \n   L = dihedral({0,0,1},N) \nELSE IF v exists AND up exists and isn't {0,0,0}: \n   L = mlookatup(v,0,up) \nELSE IF v exists: \n   L = dihedral({0,0,1},v) \n\nIF transform exists:\n   Transform = X*M*T\nELSE IF orient exists: \n   Transform = X*S*(O*R)*T\nELSE: \n   Transform = X*S*L*R*T\n"]}], "indent": 0, "level": 2, "text": ["Priorities"], "extent": [1859, 1876], "container": true, "type": "h", "id": null}, {"body": [{"body": [{"body": [{"indent": 4, "type": "para", "extent": [3436, 3753], "text": ["The shutter open transform is based off the Axis Alignment and Positioning stated above. For the shutter close transform the shutter open transform is used plus the vector ", {"text": ["v/$FPS * shutter_speed"], "type": "code"}, ". In the cases where that you have ", {"text": ["N"], "type": "code"}, " and a ", {"text": ["v"], "type": "code"}, " attribute, ", {"text": ["N"], "type": "code"}, " is used to align but ", {"text": ["v"], "type": "code"}, " is still used to blur."]}, {"body": [{"body": [{"indent": 8, "type": "para", "extent": [3763, 3974], "text": [{"text": ["v"], "type": "code"}, " is independent of the transform constructed for the Axis Alignment and Positioning. You can rotate, scale and skew all you want but v = (0,0,1) then your object will be blurred in the z direction. "]}], "indent": 4, "role": "item", "type": "note", "extent": [3753, 3763]}], "container": true, "role": "item_group", "type": "note_group"}], "indent": 0, "type": "dt", "extent": [3420, 3436], "text": ["Velocity Blur"]}, {"body": [{"indent": 4, "type": "para", "extent": [3990, 4077], "text": ["Same as Velocity Blur but the Object level transform is also taken into account. "]}], "indent": 0, "type": "dt", "extent": [3974, 3990], "text": ["Transform Blur"]}, {"body": [{"indent": 4, "type": "para", "extent": [4095, 4282], "text": ["The Axis Alignment and Positioning transform is constructed for both shutter open and close, the object level transform is also taken into account. This method is the most accurate."]}], "indent": 0, "type": "dt", "extent": [4077, 4095], "text": ["Deformation Blur"]}], "container": true, "type": "dt_group"}], "indent": 0, "level": 2, "text": ["Instancing and motion blur"], "extent": [3386, 3420], "container": true, "type": "h", "id": null}, {"body": [{"indent": 0, "type": "para", "extent": [4297, 4419], "text": ["(The image in the lower right corner of each frame is the geometry if it were instanced without any of the attributes.)"]}, {"indent": 0, "type": "para", "extent": [4419, 4451], "text": [{"text": "", "fullpath": "/copy/images/instancing.jpg", "scheme": "Image", "type": "link", "value": "images/instancing.jpg"}]}], "indent": 0, "level": 2, "text": ["Examples"], "extent": [4282, 4297], "container": true, "type": "h", "id": null}], "type": "root", "attrs": {}, "title": ["Copying and instancing point attributes"]}