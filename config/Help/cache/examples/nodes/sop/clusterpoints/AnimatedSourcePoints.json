{"body": [{"indent": 0, "text": ["Animated source points"], "type": "title", "extent": [0, 27], "level": 0}, {"indent": 0, "type": "para", "extent": [27, 354], "text": ["If you cluster point source geometry with a changing number of points, the clusters and cluster numbers can change randomly at each frame and you\u2019ll get strange results. To prevent this, you must use a couple of tricks to\ncreate the clusters based on the final number of points, and only create the clusters that are needed."]}, {"indent": 0, "type": "para", "extent": [354, 573], "text": ["First, connect the ", {"text": ["second input of the Cluster Points node"], "type": "strong"}, " to specify a set of point positions at which the ", {"text": ["Cluster Points node"], "fullpath": "/nodes/sop/clusterpoints", "scheme": "Node", "type": "link", "value": "/nodes/sop/clusterpoints"}, " should cluster the points. This is called the ", {"text": ["rest position"], "type": "em"}, "."]}, {"indent": 0, "type": "para", "extent": [573, 767], "text": ["For example, the ", {"text": ["Impact analysis tool"], "fullpath": "/nodes/dop/impactanalysis", "scheme": "Node", "type": "link", "value": "/nodes/dop/impactanalysis"}, " creates points from RBD object collisions. The number of points in the resulting geometry increases as more RBD objects collide."]}, {"body": [{"body": [{"indent": 4, "type": "para", "extent": [910, 984], "text": ["(The example file may not cache to disk for the sake of simplicity.)"]}], "indent": 0, "text": [{"text": ["Cache the impact points geometry to disk"], "fullpath": "/io/geo", "scheme": null, "type": "link", "value": "/io/geo"}, " using a ", {"text": ["ROP Output driver"], "fullpath": "/nodes/out/geometry", "scheme": "Node", "type": "link", "value": "/nodes/out/geometry"}, " and ", {"text": ["File node"], "fullpath": "/nodes/sop/file", "scheme": "Node", "type": "link", "value": "/nodes/sop/file"}, " combination."], "extent": [767, 910], "blevel": 2, "type": "ord"}, {"body": [{"indent": 4, "type": "para", "extent": [1151, 1211], "text": [{"text": "", "fullpath": "/images/dynamics/cluster_timeshift_network.png", "scheme": "Image", "type": "link", "value": "/images/dynamics/cluster_timeshift_network.png"}]}], "indent": 0, "text": ["Branch a ", {"text": ["Timeshift node"], "fullpath": "/nodes/sop/timeshift", "scheme": "Node", "type": "link", "value": "/nodes/sop/timeshift"}, " from the File node, and connect the output of the Timeshift to the Cluster Points node\u2019s second (rest position) input."], "extent": [984, 1151], "blevel": 2, "type": "ord"}, {"indent": 0, "blevel": 2, "type": "ord", "extent": [1211, 1436], "text": ["Set the Timeshift node\u2019s ", {"text": ["Frame"], "type": "ui"}, " parameter to the frame you want to cluster at, usually the last frame of the effect. You can use the ", {"text": ["$NFRAMES"], "type": "code"}, " variable, which always contains the number of the last frame in the scene."]}], "container": true, "type": "ord_group"}, {"indent": 0, "type": "para", "extent": [1436, 1889], "text": ["Second, to create the smoke boxes only as they're needed you must turn on\n", {"text": ["Continuous"], "type": "ui"}, " on the ", {"text": ["Smoke Object node"], "fullpath": "/nodes/dop/smokeobject", "scheme": "Node", "type": "link", "value": "/nodes/dop/smokeobject"}, ". This will\ncreate a new smoke box on each instance point ", {"text": ["at every frame"], "type": "em"}, ". To work\naround this so the boxes only get created at the frame where the cluster\ncenter appears, the example file uses a ", {"text": ["For Each SOP"], "fullpath": "/nodes/sop/foreach", "scheme": "Node", "type": "link", "value": "/nodes/sop/foreach"}, "\nto delete every cluster center at every frame except the frame where it\nfirst appears."]}, {"indent": 0, "type": "para", "extent": [1889, 2062], "text": ["See also ", {"fragment": "#stick", "text": ["how to make scattered points stick"], "value": "/nodes/sop/scatter#stick", "fullpath": "/nodes/sop/scatter#stick", "scheme": null, "type": "link"}, " for how to make scattered point positions and numbers consistent across frames on deforming geometry."]}], "title": ["Animated source points"], "examplefile": "/examples/nodes/sop/clusterpoints/AnimatedSourcePoints.otl", "attrs": {"type": "example"}, "type": "root", "examplefor": "/nodes/sop/clusterpoints"}